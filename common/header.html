<script type="text/discourse-plugin" version="0.8">
  import { withPluginApi } from "discourse/lib/plugin-api";
  import { createWidget } from "discourse/widgets/widget";
  
  withPluginApi("0.8", api => {
    createWidget("no-results-new-topic-widget", {
      tagName: "div.custom-new-topic-btn",
  
      html(attrs) {
        if (!this.currentUser) {
          return;
        }
  
        return this.attach('button', {
          className: 'btn-primary',
          label: 'topic.create',
          action: 'createTopic'
        });
      },
  
      createTopic() {
        const router = container.lookup('service:router');
        router.transitionTo('discovery.latest').then(() => {
          document.querySelector('.btn-default.new-topic-button')?.click();
        });
      }
    });
  });
  </script>